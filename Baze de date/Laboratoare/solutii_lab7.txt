--- lab 7

-- 2

SELECT AVG(SALARY)
FROM EMPLOYEES;

-- 3

SELECT JOB_ID, AVG(SALARY)
FROM EMPLOYEES
GROUP BY JOB_ID;

-- 4

SELECT COUNT(EMPLOYEE_ID), DEPARTMENT_ID
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID;

-- 5

SELECT COUNT(UNIQUE(MANAGER_ID))
FROM EMPLOYEES;

-- 6

SELECT max(salary)-min(salary) Diferenta
FROM employees;

-- 7

SELECT D.DEPARTMENT_NAME, D.LOCATION_ID, COUNT(E.EMPLOYEE_ID), AVG(E.SALARY)
FROM EMPLOYEES E JOIN DEPARTMENTS D ON (D.DEPARTMENT_ID = E.DEPARTMENT_ID)
GROUP BY D.DEPARTMENT_NAME, D.LOCATION_ID;

-- 8

SELECT EMPLOYEE_ID, LAST_NAME, FIRST_NAME
FROM EMPLOYEES
WHERE SALARY > (SELECT AVG(SALARY)
                FROM EMPLOYEES)
ORDER BY SALARY DESC;

-- 9

SELECT * FROM EMPLOYEES;

SELECT MIN(SALARY), MANAGER_ID
FROM EMPLOYEES
WHERE MANAGER_ID IS NOT NULL AND SALARY > 1000
GROUP BY MANAGER_ID;

-- 10

SELECT NVL(E.DEPARTMENT_ID,0),D.DEPARTMENT_NAME, MAX(E.SALARY)
FROM EMPLOYEES E JOIN DEPARTMENTS D ON (E.DEPARTMENT_ID = D.DEPARTMENT_ID)
GROUP BY E.DEPARTMENT_ID, D.DEPARTMENT_NAME
HAVING MAX(E.SALARY) >= 3000;

-- 11

SELECT MIN(AVG(SALARY))
FROM EMPLOYEES
GROUP BY JOB_ID;

-- 12

SELECT MAX(AVG(SALARY))
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID;

-- 14

SELECT AVG(SALARY)
FROM EMPLOYEES
HAVING AVG(SALARY) > 2500;

-- 15

SELECT DEPARTMENT_ID, JOB_ID, SUM(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID, JOB_ID;

-- 16

SELECT DEPARTMENT_ID, DEPARTMENT_NAME, COUNT(EMPLOYEE_ID) "NUMAR ANG"
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
HAVING COUNT(EMPLOYEE_ID) < 4
GROUP BY DEPARTMENT_ID, DEPARTMENT_NAME;

SELECT DEPARTMENT_ID, DEPARTMENT_NAME, COUNT(EMPLOYEE_ID) "NUMAR ANG"
FROM EMPLOYEES JOIN DEPARTMENTS USING (DEPARTMENT_ID)
HAVING COUNT(EMPLOYEE_ID) = (SELECT MAX(COUNT(EMPLOYEE_ID))
                            FROM EMPLOYEES
                            GROUP BY DEPARTMENT_ID)
GROUP BY DEPARTMENT_ID, DEPARTMENT_NAME;

-- 18

SELECT COUNT(COUNT(DEPARTMENT_ID))
FROM EMPLOYEES
HAVING COUNT(*) >= 15
GROUP BY DEPARTMENT_ID;

-- 19

SELECT NVL(DEPARTMENT_ID,0), SUM(SALARY)
FROM EMPLOYEES
WHERE DEPARTMENT_ID != 30
HAVING COUNT(EMPLOYEE_ID) > 10
GROUP BY DEPARTMENT_ID
ORDER BY SUM(SALARY);

-- 20

SELECT EMPLOYEE_ID
FROM JOB_HISTORY
HAVING COUNT(JOB_ID) >= 2
GROUP BY EMPLOYEE_ID;

-- 21

SELECT AVG(NVL(COMMISSION_PCT,0))
FROM EMPLOYEES;

-- 22

SELECT job_id, SUM(DECODE(department_id, 30, salary)) Dep30,
SUM(DECODE(department_id, 50, salary)) Dep50,
SUM(DECODE(department_id, 80, salary)) Dep80,
SUM(salary) Total
FROM employees
GROUP BY job_id;